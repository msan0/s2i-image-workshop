#!/bin/sh

echo "Assembling!"
mkdir -p /opt/app-root/www
cp -Rf /tmp/src/. /opt/app-root/www
cd /opt/app-root/www

if [ "$(ls /tmp/artifacts/password 2>/dev/null)" ]; then
    mv /tmp/artifacts/password /opt/app-root/src/password
    chgrp root /opt/app-root/src/password
    echo "Restored password $(cat /opt/app-root/src/password)"
else
    date | md5sum > /opt/app-root/src/password
    echo "Generated password $(cat /opt/app-root/src/password)"
fi